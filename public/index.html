<!DOCTYPE html>
<html>

<head>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.js">
		< /script
		<!-- Latest compiled and minified CSS -->
		< link rel = "stylesheet"
		href = "https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
		integrity = "sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
		crossorigin = "anonymous" >
			<!-- Latest compiled and minified JavaScript -->
			< script src = "https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
		integrity = "sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
		crossorigin = "anonymous" >
	</script>
	<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
	<script type="text/javascript">
		// Load the Visualization API and the corechart package.
		google.charts.load('current', {
			'packages': ['corechart']
		});

		// Set a callback to run when the Google Visualization API is loaded.
		google.charts.setOnLoadCallback(drawChart);

		// Callback that creates and populates a data table,
		// instantiates the pie chart, passes in the data and
		// draws it.
		function drawChart() {

			// Create the data table.
			var data = new google.visualization.DataTable();
			data.addColumn('number', 'Play');
			$.ajax("/scores", {
				data: {
					players: ["Rafis", "Cookiezi", "hvick225", "AngeLMegumin", "Vaxei"]
				},
				success: onDataSuccess
			});

			function onDataSuccess(response) {
				console.log(arguments)
				var playerData = response;
				len = playerData.length,
					rows = [];

				for (var i = 0; i < len; ++i) {
					var player = playerData[i];
					console.log(player)

					data.addColumn('number', player.name);
				}
				console.log(data, playerData);
				for (i = 0; i < len; ++i) {
					var player = playerData[i];
					var scores = player.data,
						scoresLen = scores.length;
					for (var scoreIndex = 0; scoreIndex < scoresLen; ++scoreIndex) {
						if (rows[scoreIndex]) {
							rows[scoreIndex].push(Number(scores[scoreIndex]));
						} else {
							rows[scoreIndex] = [scoreIndex + 1, Number(scores[scoreIndex])];
						}
					}
				}
				data.addRows(rows);

				// Set chart options
				var options = {
					'title': 'The Top Five Players\' Top Plays',
					'chartArea': {
						width: '800',
						height: '600'
					},
					'width': '100%',
					'height': '800',
					'vAxis': {
						'title': "Unweighted PP"
					},
					'hAxis': {
						'title': "Play position"
					},
					'pointSize': 5
					
				};

				// Instantiate and draw our chart, passing in some options.
				var chart = new google.visualization.LineChart(document.getElementById('chart_div'));
				chart.draw(data, options);
			}
		}
	</script>
</head>

<body>
	<div class="container">
		<div id="chart_div"></div>
	</div>
</body>

</html>